<div class="dashboard-container">
  <div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-4 mt-3">
    <div>
      <h2 class="fw-bold mb-0">Dashboard</h2>
      <p class="text-muted small">System overview and statistics</p>
    </div>
    <div class="btn-group">
      <button class="btn btn-outline-secondary btn-sm" title="Refresh dashboard" onclick="window.location.reload()">
        <i class="bi bi-arrow-repeat"></i> Refresh
      </button>
    </div>
  </div>

  <!-- Stats Cards Section -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-center h-100">
        <div class="card-body">
          <h5 class="card-title">Sources</h5>
          <h2 class="card-text"><%= @stats[:sources_count] %></h2>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center h-100">
        <div class="card-body">
          <h5 class="card-title">Collections</h5>
          <h2 class="card-text"><%= @stats[:collections_count] %></h2>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center h-100">
        <div class="card-body">
          <h5 class="card-title">Records</h5>
          <h2 class="card-text"><%= @stats[:records_count] %></h2>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card text-center h-100">
        <div class="card-body">
          <h5 class="card-title">Destinations</h5>
          <h2 class="card-text"><%= @stats[:destinations_count] %></h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Sources with Collections Section -->
  <div class="row mb-4">
    <div class="col-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Top 5 sources by no. of collections</h5>
          <% if @sources_with_collections.any? %>
            <table class="table table-hover">
              <thead>
              <tr>
                <th>#</th>
                <th>Source</th>
                <th>Collections</th>
              </tr>
              </thead>
              <tbody>
              <% @sources_with_collections.each_with_index do |source, idx| %>
                <tr>
                  <td><%= idx + 1 %></td>
                  <td>
                    <%= link_to source.name, source_path(source), class: "text-decoration-none" %>
                  </td>
                  <td><%= source.collections_count %></td>
                </tr>
              <% end %>
              </tbody>
            </table>
          <% else %>
            <p class="text-center">No sources available yet.</p>
          <% end %>
          <%= link_to "View all sources", sources_path, class: "btn btn-outline-primary btn-sm" %>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Top 5 collections by no. of records</h5>
          <% if @collections_with_records.any? %>
            <table class="table table-hover">
              <thead>
              <tr>
                <th>#</th>
                <th>Collection</th>
                <th>Records</th>
              </tr>
              </thead>
              <tbody>
              <% @collections_with_records.each_with_index do |collection, idx| %>
                <tr>
                  <td><%= idx + 1 %></td>
                  <td>
                    <%= link_to collection.name, collection_path(collection), class: "text-decoration-none" %>
                  </td>
                  <td><%= collection.records_count %></td>
                </tr>
              <% end %>
              </tbody>
            </table>
          <% else %>
            <p class="text-center">No collections available yet.</p>
          <% end %>
          <div class="text-end">
            <%= link_to "Search for records", records_path, class: "btn btn-outline-primary btn-sm" %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Section (Placeholder) -->
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h5>Recent Imports</h5>
          <p class="text-muted">Future feature: Recent import activity will be displayed here.</p>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h5>Recent Transfers</h5>
          <p class="text-muted">Future feature: Recent transfer activity will be displayed here.</p>
        </div>
      </div>
    </div>
  </div>
</div>